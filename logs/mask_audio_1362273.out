===== Audio Masking Job Information =====
Job ID: 1362273
Node: gx10
CPU Count: 64
Memory: 524288MB
Time Limit: 
Start Time: Thu Oct 16 16:44:29 CEST 2025
===========================================
Activating virtual environment...
Python version: Python 3.12.3
Available CPU cores: 64
Starting audio masking processing...
Configuration:
  Input directory: data/CommonVoiceEN
  Output base: data/CommonVoiceEN (default)
  Sample rate: 16000 Hz
  Batch size: 128
  Number of workers: 64
  Log level: INFO
  Splits: all splits
  Dry run: false
===========================================
Command: python scripts/mask_audio.py --input-dir data/CommonVoiceEN --sample-rate 16000 --batch-size 128 --num-workers 64 --log-level INFO
===========================================
2025-10-16 16:44:32,318 - INFO - Python version: 3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]
2025-10-16 16:44:32,318 - INFO - Available CPU cores: 224
2025-10-16 16:44:32,338 - INFO - Initial memory usage: 136.3 MB
2025-10-16 16:44:32,338 - INFO - === Starting dataset processing ===
2025-10-16 16:44:32,338 - INFO - Input directory: data/CommonVoiceEN
2025-10-16 16:44:32,338 - INFO - Output base: data/CommonVoiceEN
2025-10-16 16:44:32,338 - INFO - Target sample rate: 16000 Hz
2025-10-16 16:44:32,338 - INFO - Batch size: 128
2025-10-16 16:44:32,338 - INFO - Number of workers: 64
2025-10-16 16:44:32,338 - INFO - Loading dataset from: data/CommonVoiceEN
2025-10-16 16:44:32,339 - INFO - Loading from HuggingFace cache directory...
2025-10-16 16:44:34,421 - INFO - Dataset loaded successfully
2025-10-16 16:44:34,421 - INFO - Available splits: ['train', 'validation', 'test', 'other', 'invalidated']
2025-10-16 16:44:34,421 - INFO -   - train: 1090061 samples
2025-10-16 16:44:34,421 - INFO -   - validation: 16390 samples
2025-10-16 16:44:34,421 - INFO -   - test: 16390 samples
2025-10-16 16:44:34,421 - INFO -   - other: 299335 samples
2025-10-16 16:44:34,421 - INFO -   - invalidated: 288077 samples
2025-10-16 16:44:34,421 - INFO - Total samples to process: 1,710,253
2025-10-16 16:44:34,421 - INFO - Initial memory usage: 197.5 MB
2025-10-16 16:44:34,423 - INFO - üîß Large dataset detected! Applying optimizations:
2025-10-16 16:44:34,423 - INFO -    - Recommended batch size: 64-128 (current: 128)
2025-10-16 16:44:34,423 - INFO -    - Recommended workers: 8-16 (current: 64)
2025-10-16 16:44:34,423 - INFO -    - Estimated processing time: 1425.2 - 712.6 minutes
2025-10-16 16:44:34,423 - INFO -    - Consider processing splits separately: --splits train
2025-10-16 16:44:34,423 - WARNING - ‚ö†Ô∏è  Very large dataset! Reducing workers from 64 to 12 to prevent memory issues
2025-10-16 16:44:34,423 - INFO - Created output directory for normal: data/CommonVoiceEN_normal
2025-10-16 16:44:34,424 - INFO - Created output directory for lfloss: data/CommonVoiceEN_lfloss
2025-10-16 16:44:34,426 - INFO - Created output directory for hfloss: data/CommonVoiceEN_hfloss
2025-10-16 16:44:34,426 - INFO - Setting up output dataset structures...
2025-10-16 16:44:34,426 - INFO - Copying dataset structure files...
2025-10-16 16:45:01,248 - INFO - Copying 1 metadata files for normal...
2025-10-16 16:45:02,431 - INFO - Copying 1 metadata files for lfloss...
2025-10-16 16:45:03,542 - INFO - Copying 1 metadata files for hfloss...
2025-10-16 16:45:03,550 - INFO - Dataset structure setup completed
2025-10-16 16:45:03,551 - INFO - Hearing loss profiles:
2025-10-16 16:45:03,552 - INFO -   normal: {np.int64(125): np.float32(10.0), np.int64(250): np.float32(10.0), np.int64(500): np.float32(10.0), np.int64(1000): np.float32(10.0), np.int64(2000): np.float32(10.0), np.int64(4000): np.float32(10.0), np.int64(8000): np.float32(10.0)}
2025-10-16 16:45:03,552 - INFO -   lfloss: {np.int64(125): np.float32(100.0), np.int64(250): np.float32(85.0), np.int64(500): np.float32(70.0), np.int64(1000): np.float32(55.0), np.int64(2000): np.float32(40.0), np.int64(4000): np.float32(25.0), np.int64(8000): np.float32(10.0)}
2025-10-16 16:45:03,552 - INFO -   hfloss: {np.int64(125): np.float32(10.0), np.int64(250): np.float32(25.0), np.int64(500): np.float32(40.0), np.int64(1000): np.float32(55.0), np.int64(2000): np.float32(70.0), np.int64(4000): np.float32(85.0), np.int64(8000): np.float32(100.0)}
2025-10-16 16:45:03,552 - INFO - 
=== Processing split: train (1,090,061 samples) ===
2025-10-16 16:45:03,552 - INFO - Processing 1090061 samples in batches of 128 using 12 workers
2025-10-16 16:45:03,553 - WARNING - Large dataset detected! Reducing workers from 12 to 8 to prevent memory issues
2025-10-16 16:45:03,553 - INFO - Processing chunk 1/110: samples 0-9999
2025-10-16 16:48:07,159 - WARNING - High memory usage: 45941.8 MB
2025-10-16 16:48:07,159 - INFO - Processing chunk 2/110: samples 10000-19999
2025-10-16 16:51:12,410 - WARNING - High memory usage: 69667.7 MB
2025-10-16 16:51:12,410 - INFO - Processing chunk 3/110: samples 20000-29999
2025-10-16 16:54:23,529 - WARNING - High memory usage: 91898.6 MB
2025-10-16 16:54:23,529 - INFO - Processing chunk 4/110: samples 30000-39999
